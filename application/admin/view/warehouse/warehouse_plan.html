<link rel="stylesheet" href="{:ADMIN_STYLE_URL}css/warehouse.css" type="text/css" media="screen" />    <script>    $(function(){    warehousetable.planStart();    {if condition="isset($right)"}    var kyoPopupMenu={};        kyoPopupMenu = (function(){            return {            sys: function (obj){                $('.popup_menu').remove();                popupMenuApp = $('<div class="popup_menu app-menu"><ul><li><a menu="menu1">查看</a></li><li><a menu="menu2">规划</a></li><li><a menu="menu3">添加材料明细</a></li><li><a menu="menu4">移除</a></li></ul></div>')                        .find('a').attr('href','javascript:;')                        .end().appendTo('body');                //绑定事件                $('.app-menu a[menu="menu1"]').on('click', function (){                                        if($(obj.target).is('label') == false  ||  $(obj.target).attr('class')!='material' ){                       alert('请右键选择库里面的材料');                        $('.popup_menu').hide();                        return;                    }                    var targetId = obj.target.id;                                        var arr = targetId.split('_');                                        targetId = arr[1];                                        openModel.openWindow('{:url('/admin/warehouse/getMaterials','type=bath')}'+'?wtm_id='+targetId);                                       $('.popup_menu').hide();                });                $('.app-menu a[menu="menu2"]').on('click', function (){                     var targetId = obj.target.id;                     if($(obj.target).is('td') == false){                        targetId = $(obj.target).parent().attr('id');                     }                    openModel.openWindow('{:url('/admin/warehouse/showMaterial')}'+'?wt_id='+targetId);                    $('.popup_menu').hide();                                    });                $('.app-menu a[menu="menu3"]').on('click', function (){                                         if($(obj.target).is('label') == false  ||  $(obj.target).attr('class')!='material' ){                       alert('请右键选择库里面的材料');                        $('.popup_menu').hide();                        return;                    }                    var targetId = obj.target.id;                                        var arr = targetId.split('_');                                        targetId = arr[1];                                       openModel.openWindow('{:url('/admin/warehouse/showMaterialDetail')}'+'?wtm_id='+targetId);                                       $('.popup_menu').hide();                                    });                $('.app-menu a[menu="menu4"]').on('click', function (){                                       if($('#'+obj.target.id).is('label') == false){                       alert('请右键点击要操作的原材料！');                       $('.popup_menu').hide();                       return ;                   }                                       if(!confirm('确定移除？')) return ;                                       var namelist = $('#'+obj.target.id).html().split(':');                   var ids = obj.target.id.split("_");                                           warehousetable.delPlan(ids[1]);                                   });                 return popupMenuApp;            }        }})();    //取消右键    $('.product').on('contextmenu', function (){return false;}).click(function(){        $('.popup_menu').hide();    });    //桌面点击右击    $('.product').on('contextmenu',function (e){        var popupmenu = kyoPopupMenu.sys(e);        l = ($(document).width() - e.clientX) < popupmenu.width() ? (e.clientX - popupmenu.width()) : e.clientX;        t = ($(document).height() - e.clientY) < popupmenu.height() ? (e.clientY - popupmenu.height()) : e.clientY;        popupmenu.css({left: l,top: t}).show();        return false;    });    {/if}})</script><div class="canvas_title do-clear">    <ul class="tab_nav fl">        <li class="current"><a href="javaScript:void(0)">仓库列表</a></li>    </ul>    </div><div class="canvas_intro">                <br/><br/><br/>   <h5 align='center' class='title'><input type="hidden" id='wttype' value="1">{$list.name} 仓库规划</h5>       <table class="product" >                        {for start="$list.x" end="0" comparison="gt" step='-1'  name="i"}                    <tr>                                        {volist name='$list.warehousetables'  id='vt' key='kt'}                            {if condition="$i==$vt.p_x"}                                {assign name="childs" value=":GetWarehouseChild($vt.id)"}                                {if condition="!empty($childs)"}                                <td name='father' >                                    <table class="productchild"  >                                        <tr>                                            {volist name='$childs'  id='vc' key='kc'}                                            <td name='child' id="{$vc.id}"> <input type='hidden' id='volume_{$vc.id}' name='volume' value="{$vc.volume}"  readonly='readonly' >                                                {assign name="materials" value=':GetTargets("select * from ink_wtable_material where wt_id=".$vc.id)'}                                                {if condition='!empty($materials)'}                                                <label  class='labeltitle'>{$vc.name}&nbsp;<a class="addbtn">添加</a></label><br>                                                 {volist name='$materials'  id='vm' key='km'}                                                                                                       <label class='material' id="label_{$vm.id}" style='white-space:nowrap;'>{$vm.m_name} </label>&nbsp;<a id='deletebtn_{$vm.id}' class="deletebtn" style='white-space:nowrap;'>删除</a>                                                    <br>                                                {/volist}                                                {else}                                                    <label  class='labeltitle' style='white-space:nowrap;'>{$vc.name}                                                     &nbsp;<a class="addbtn">添加</a></label><br>                                                {/if}                                            </td>                                            {/volist}                                        </tr>                                    </table>                                </td>                                {else}                                    <td name='father' id="{$vt.id}"><input type='hidden' id='volume_{$vt.id}' name='volume' value="{$vt.volume}" readonly='readonly'>                                        {assign name="materials" value=':GetTargets("select * from ink_wtable_material where wt_id=".$vt.id)'}                                        {if condition='!empty($materials)'}                                        <label class='labeltitle'>{$vt.name}<a class="addbtn">添加</a></label><br>                                         {volist name='$materials'  id='vm' key='km'}                                        <label class='material' id="label_{$vm.id}" style='white-space:nowrap;'>{$vm.m_name}&nbsp;</label><a class="deletebtn" id='deletebtn_{$vm.id}' style='white-space:nowrap;'>删除</a><br>                                        {/volist}                                        {else}                                            <label  class='labeltitle'style='white-space:nowrap;'>{$vt.name}&nbsp;<a class="addbtn">添加</a></label><br>                                                                                                                                 {/if}                                    </td>                                {/if}                            {/if}                     {/volist}                     </tr>            {/for}    </table>  </div><div class="message" id="tip_windows">    <div class="box">        <h3><label id='title'><label><a href="javaScript:windowoperation.hide($('#tip_windows'))" class="close"><img src="{:ADMIN_STYLE_URL}images/closecut.png" /></a></h3>        <br>           <input name="" type="hidden" value="" id="wtm_id" />        <br>        <li align='center'>            <label id="label_name"></label>                    </li>    <br>        <div class="btn"><a href="javaScript:warehousetable.delPlan('post','','','');">确认</a><a href="javaScript:warehousetable.closeTip();">取消</a></div>    </div></div>