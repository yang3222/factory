<?phpnamespace app\user\controller;use \app\user\controller;use \app\user\model\Menu as MenuModel;use \app\user\model\Productfactory;/* * To change this license header, choose License Headers in Project Properties. * To change this template file, choose Tools | Templates * and open the template in the editor. *//** * Description of Index * * @author 27532 */class Menu extends Base{    //put your code here    protected $pageTotalItem=120;    public function __construct() {        parent::__construct();        $this->assign('title','分类管理');        $this->assign('currentMenu',array('menu'=>'menu3','nav'=>'nav0'));    }    public function index(){        $menu=new MenuModel();        $data=$menu->where('user_id','=',$this->user_id)->order('id desc')->paginate($this->pageTotalItem,false,['query' =>request()->param()]);        $this->assign('data',$data);        $this->assign('pageDiv', $data->render());        return $this->fetch();    }    //添加    public function add(){        $data=  array('id'=>'','name'=>'','product'=>'','sort'=>'0','display'=>'1');        $productfactory=new Productfactory();        if($this->user_id!="29"){            $productfactory->where('factory_id','=',$this->user_id);        }        $products=$productfactory->order('product_id desc')->group('product_id')->select();        $this->assign('canvasTitle','添加分类信息');        $this->assign('data',$data);        $this->assign('products',$products);        $this->assign('eventJS','menu');        return $this->fetch('menu/edit');    }    //编辑    public function edit($id){        $data=  MenuModel::get($id);        $productfactory=new Productfactory();        if($this->user_id!="29"){            $productfactory->where('factory_id','=',$this->user_id);        }        $products=$productfactory->order('product_id desc')->group('product_id')->select();        $this->assign('canvasTitle','修改分类信息');        $this->assign('data',$data);        $this->assign('products',$products);        $this->assign('eventJS','menu');        return $this->fetch();    }    public function post(){        $id=input('post.id');        if(!empty($id)){            //修改            $data=  MenuModel::get($id);        }else{            //添加            $data=new MenuModel();            $data->user_id=$this->user_id;        }        $data->name=input('post.name');        $data->sort=input('post.sort');        $data->product=input('post.product');        $data->display=input('post.display');        if($data->save()!==false){            echo true;        }else{            echo "保存失败，请重新保存";        }    }    //删除内容    public function delete(){        $inputs=input();        $ids=$inputs['ids'];        $model=new MenuModel();        $model->where('id','in',$ids)->delete();        echo true;    }}