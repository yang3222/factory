<?php if (!defined('THINK_PATH')) exit(); /*a:6:{s:88:"D:\project\factory\public/../application/admin\view\warehouse\material_detail_lists.html";i:1591836799;s:60:"D:\project\factory\application\admin\view\common\layout.html";i:1584407225;s:60:"D:\project\factory\application\admin\view\common\member.html";i:1584407225;s:61:"D:\project\factory\application\admin\view\common\topline.html";i:1584407225;s:58:"D:\project\factory\application\admin\view\common\menu.html";i:1584407225;s:61:"D:\project\factory\application\admin\view\common\mapline.html";i:1584407225;}*/ ?>
<!doctype html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  user-scalable=0" name="viewport" /><title>管理后台</title><link rel="stylesheet" href="<?php echo ADMIN_STYLE_URL; ?>css/r.css" type="text/css" media="screen" /><link rel="stylesheet" href="<?php echo ADMIN_STYLE_URL; ?>css/style.css?v=1.0" type="text/css" media="screen" /><script type="text/javascript" src="<?php echo ADMIN_STYLE_URL; ?>js/jquery.min.js"></script><script type="text/javascript" src="<?php echo LAYER_JS_URL; ?>layer.js"></script><?php if(isset($eventJS)): ?><script type="text/javascript" src="<?php echo ADMIN_STYLE_URL; ?>js/<?php echo $eventJS; ?>.js"></script><?php endif; ?><script type="text/javascript" src="<?php echo ADMIN_STYLE_URL; ?>js/move.js"></script></head><body class="content">   <div class="topline">
      <h1><img src="<?php echo ADMIN_STYLE_URL; ?>images/logo.png" /></h1>
      <ul class="rightbox">
         <li>
            <a href="javaScript:;" class="fa move_over"><span><?php echo session('admin_name'); ?></span></a>
            <ul class="nav">
                <li><a href="<?php echo url('/admin/login/logout'); ?>">退出登录</a></li>
               <li><a href="<?php echo url('/admin/acount/editpwd'); ?>">修改密码</a></li>
            </ul>
         </li>
         <!--<li class="delete"><a href="#">删除缓存</a></li>-->
      </ul>
   </div>   <div class="contentbox do-clear">      <ul class="menubox">
    <?php if(is_array($menu) || $menu instanceof \think\Collection || $menu instanceof \think\Paginator): $mkey = 0; $__LIST__ = $menu;if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$value): $mod = ($mkey % 2 );++$mkey;?>
    <li <?php if($currentMenu['menu']==$key): ?>class="open"<?php endif; ?>>
        <?php $menuKey = $key; ?>
        <a href="<?php if(isset($value['url'])): ?><?php echo $value['url']; else: ?>javaScript:;<?php endif; ?>"><i class="<?php echo $value['class']; ?>"></i><?php echo $value['title']; ?></a>
        <?php if(!empty($value['nav'])): ?>
        <ul>
        <?php if(is_array($value['nav']) || $value['nav'] instanceof \think\Collection || $value['nav'] instanceof \think\Paginator): $navKey = 0; $__LIST__ = $value['nav'];if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$li): $mod = ($navKey % 2 );++$navKey;?>
            <li <?php if($currentMenu['nav']==$key&&$currentMenu['menu']==$menuKey): ?>class="current"<?php endif; ?>><a href="<?php echo $li['url']; ?>" <?php if(isset($li['target'])): ?>target="<?php echo $li['target']; ?>"<?php endif; ?> ><?php echo $li['title']; ?></a></li>
        <?php endforeach; endif; else: echo "" ;endif; ?>
        </ul>
        <?php endif; ?>
    </li>
    <?php endforeach; endif; else: echo "" ;endif; ?>
</ul>      <div class="rightbox">         <div class="menumap">    <a href="<?php echo url('/user/index'); ?>" class="home">首页</a>    <?php if(isset($menu[$currentMenu['menu']])): ?><a href="javaScript:;"><?php echo $menu[$currentMenu['menu']]['title']; ?></a><?php endif; if(isset($menu[$currentMenu['menu']]['nav'][$currentMenu['nav']])): ?><span><?php echo $menu[$currentMenu['menu']]['nav'][$currentMenu['nav']]['title']; ?></span><?php endif; ?></div>         <div class="canvas">            <style>    div.printcent {        /*position: absolute;*/        left: -100px;    }    .qrcodeimg {        margin: 1px;        width: 200px;        /*height: 151.8px;*/        /*transform:scale(0.8)*/    }    /*input[type='checkbox'] {        display: none;    }*/    input[type='checkbox'] + label {        border-radius: 4px;        display: inline-block;        cursor: pointer;        /*height: 155px;*/        width: 204px;        margin-bottom: 2px;        margin-right: 2px;        line-height: 36px;        background: #fff;        border: 1px solid #ccc;        text-align: center;        font-weight: bold;        font-size: 18px;    }</style><script>    $(function(){        mdl_qr.select();    })</script><div class="canvas_title do-clear">    <ul class="tab_btn tab_btn_fl fl">        <li><a href="<?php echo url('/admin/warehouse/materialDetailDo','action=Add'); ?>">添加</a></li>         <li><a href="javaScript:materialdetail.deleteAll('<?php echo url('/admin/warehouse/materialDetailDel'); ?>')">删除</a></li>                <li><a href="<?php echo url('/admin/warehouse/exportExcel'); ?>" download='物料.xlsx' target="_blank">导出Excel数据</a></li>        <li><a href="javaScript:print_some();">打印所选</a></li>        <li><a href="javaScript:print();">打印全部</a></li>         <li>           <select id="status">               <option value="all">全部</option>                <option value="0">未规划</option>               <option value="1">已规划入库</option>              <option value="2">已入库</option>           </select>         </li>        <li class="input"><input type="text" id="search" name="search" value=""       onkeydown="keyFun.key(event,13,search.search,[$('#search'),'<?php echo url('/admin/warehouse/materialDetailLists'); ?>'])"       placeholder="搜索：名称/编码" /></li>       <li><a href="javaScript:search.searchArray(['<?php echo url('/admin/warehouse/materialDetailLists'); ?>','search','status'])">搜索</a></li>    </ul>    <?php echo $pageDiv; ?></div><div class="canvas_intro">    <table class="productli">        <thead>            <tr>                <th width="10" class="center">#</th>                <th width="10" class="center"><input name="" type="checkbox" value="" id="select" /></th>                <th width="140">物料名称</th>                                <th width="140">库位</th>                                <th width="50" class="center">入库数量/库存</th>                <th width="50" class="center">价格</th>                <th width="100" class="center">供应商</th>                <!--<th width="100" class="center">二维码</th>-->                <th width="36" class="center">状态</th>                                <th width="36" class="center" >入库状态</th>                <th class="center" width="200">操作</th>            </tr>        </thead>        <tbody>            <?php if(is_array($list) || $list instanceof \think\Collection || $list instanceof \think\Paginator): $k = 0; $__LIST__ = $list;if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$value): $mod = ($k % 2 );++$k;?>            <tr>                <td class="center"><?php echo $k; ?></td>                <td class="center"><input name="select" type="checkbox" value="<?php echo $value['id']; ?>" /></td>                <td><?php echo $value['name']; ?></td>                                <td><?php echo $value['warehouse_num']; ?></td>                <td class="center"><?php echo $value['count']; ?>/<?php if($value['whmdetail']['status']=='2'): ?><?php echo $value['whmdetail']['count']; else: ?>0<?php endif; ?></td>                <td class="center">￥<?php echo sprintf('%.2f',$value['money']); ?></td>                <td class="center"><?php echo $value['upplier']['company']; ?></td>                <!--<td class="center"><img src=":url('/admin/productionstatusset/getProStaCodeBar','text='.$value.id.'&ab='.$value.name)" /></td>-->                <td class="center radio" ><?php if($value['status']=='1'): ?><span>合格</span><?php else: ?><span class="close">瑕疵品</span><?php endif; ?></td>                                <td   class="center radio">                    <?php if($value['whmdetail']['status']=='2'): ?>                        <span>已入库</span>                    <?php elseif($value['whmdetail']['status']=='1'): ?>                        <span style="background: #D2691E;">已规划</span>                     <?php elseif($value['whmdetail']['status']=='0'): ?>                        <span class="close">未规划</span>                     <?php endif; ?>                 </td>                <td class="center operation">                    <a href="<?php echo url('/admin/warehouse/viewMaterial','id='.$value['material_id']); ?>">查看仓库</a>                                        <a href="<?php echo url('/admin/warehouse/materialDetailDo','action=edit'); ?>?id=<?php echo $value['id']; ?>">编辑</a>                                                            <a <?php if($value['whmdetail']['status']=='2'): else: ?>href="javaScript:materialdetail.delete('<?php echo $value['id']; ?>','<?php echo url('/admin/warehouse/materialDetailDel'); ?>')"<?php endif; ?>>删除</a>                                   </td>            </tr>            <?php endforeach; endif; else: echo "" ;endif; ?>        </tbody>    </table></div><div class="canvas_title do-clear">    <ul class="tab_btn tab_btn_fl fl">        <li><a href="javaScript:print_some();">打印所选</a></li>        <li><a href="javaScript:print();">打印全部</a></li>    </ul>    <?php echo $pageDiv; ?></div><!--<br/> <br/><br/> <br/><br/> <br/><br/> <br/><br/> <br/><br/> <br/><br/> <br/><br/> <br/>--><div class="printcent" id="printcent" style="display: none;">    <?php if(is_array($list) || $list instanceof \think\Collection || $list instanceof \think\Paginator): $k = 0; $__LIST__ = $list;if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$value): $mod = ($k % 2 );++$k;?>        <div id="print<?php echo $value['id']; ?>" class="printdiv no-print"><input class="printinput no-print" type="checkbox" name="printqrcode"  id="printqrcode<?php echo $value['id']; ?>" value="print<?php echo $value['id']; ?>"><label for="printqrcode<?php echo $value['id']; ?>">            <img class="qrcodeimg" src="<?php echo url('/admin/warehouse/getclQrCode').'?text='.$value['id'].'&name='.$value['name'].'&shelf_code='.$value['warehouse_num'].'&p_time='.$value['purchases_date'].'&p_size='.$value['size'].'&num='.$value['count'].'&fac='.$value['upplier']['company']; ?>"/></label></div><!--<div id="heiprint$value.id" class="hei no-print" style="height:750px;"></div>--><div style="page-break-after:always;"></div>        <?php endforeach; endif; else: echo "" ;endif; ?></div><script type="text/javascript" src="<?php echo ADMIN_STYLE_URL; ?>js/jquery.min.js"></script><script type="text/javascript" src="<?php echo ADMIN_STYLE_URL; ?>js/jQuery.jsprint.js"></script><script>    var mdl_qr = {        windowurl:"",        openWindow:function(url){            $("#swfbox").show();            if(mdl_qr.windowurl!=url){                mdl_qr.windowurl=url;                $("#swfbox").html("");                mdl_qr.loadURL({});            }        },        close_select:function(){            //$("#select").change(function(){            $("input[name=printqrcode]").prop('checked',0);//,$("#select").prop("checked")            $("div.printdiv").addClass('no-print');//,$("#select").prop("checked")            $("div.hei").addClass('no-print');            //})        },        select:function(){            $("#select").change(function(){                $("input[name=select]").prop('checked',$("#select").prop("checked"));            })        },        close: function () {            $("#swfbox").hide();        },        loadURL:function(obj){            $.post(mdl_qr.windowurl,obj,function(data){                $("#swfbox").html(data);            })        },    };    function print() {        $("#printcent").show();        $("input[name=printqrcode]").prop('checked', 1);//,$("#select").prop("checked")        $("div.printdiv").removeClass('no-print');//,$("#select").prop("checked")        $("div.hei").removeClass('no-print');        $("#printcent").print({            globalStyles: true,            mediaPrint: true,            stylesheet: null,            noPrintSelector: ".no-print",            iframe: true,            append: null,            prepend: null,            manuallyCopyFormValues: true,            deferred: $.Deferred(),            timeout: 90000000,            title: null,            doctype: '<!doctype html>'        });        $("#printcent").hide();    }    function print_some() {        $("div.printdiv").addClass('no-print');        $("div.hei").addClass('no-print');        var idarr=[];        $('input:checkbox[name=select]:checked').each(function(k){            if($(this).val()!='')idarr.push('print' + $(this).val());        });        if (idarr.length <= 0) {            alert('请选择要打印的图片');            return;        }console.log(idarr);        for (var i = 0; i < idarr.length; i++) {            $("#"+idarr[i]).removeClass('no-print');            $("#hei"+idarr[i]).removeClass('no-print');        }        //$("input[name=printqrcode]").prop('checked', 1);//,$("#select").prop("checked")        //$("div.printdiv").removeClass('no-print');//,$("#select").prop("checked")        $("#printcent").show();        $("#printcent").print({            globalStyles: true,            mediaPrint: false,            stylesheet: null,            noPrintSelector: ".no-print",            iframe: true,            append: null,            prepend: null,            manuallyCopyFormValues: true,            deferred: $.Deferred(),            timeout: 90000000,            title: null,            doctype: '<!doctype html>'        });        $("#printcent").hide();    }</script>         </div>      </div>   </div>   <div class="swf_edit_box" id="swfbox"></div></body></html>