<?php if (!defined('THINK_PATH')) exit(); /*a:6:{s:83:"D:\project\factory\public/../application/admin\view\epwarehouse\warehouse_plan.html";i:1586501120;s:60:"D:\project\factory\application\admin\view\common\layout.html";i:1584407225;s:60:"D:\project\factory\application\admin\view\common\member.html";i:1584407225;s:61:"D:\project\factory\application\admin\view\common\topline.html";i:1584407225;s:58:"D:\project\factory\application\admin\view\common\menu.html";i:1584407225;s:61:"D:\project\factory\application\admin\view\common\mapline.html";i:1584407225;}*/ ?>
<!doctype html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  user-scalable=0" name="viewport" /><title>管理后台</title><link rel="stylesheet" href="<?php echo ADMIN_STYLE_URL; ?>css/r.css" type="text/css" media="screen" /><link rel="stylesheet" href="<?php echo ADMIN_STYLE_URL; ?>css/style.css?v=1.0" type="text/css" media="screen" /><script type="text/javascript" src="<?php echo ADMIN_STYLE_URL; ?>js/jquery.min.js"></script><script type="text/javascript" src="<?php echo LAYER_JS_URL; ?>layer.js"></script><?php if(isset($eventJS)): ?><script type="text/javascript" src="<?php echo ADMIN_STYLE_URL; ?>js/<?php echo $eventJS; ?>.js"></script><?php endif; ?><script type="text/javascript" src="<?php echo ADMIN_STYLE_URL; ?>js/move.js"></script></head><body class="content">   <div class="topline">
      <h1><img src="<?php echo ADMIN_STYLE_URL; ?>images/logo.png" /></h1>
      <ul class="rightbox">
         <li>
            <a href="javaScript:;" class="fa move_over"><span><?php echo session('admin_name'); ?></span></a>
            <ul class="nav">
                <li><a href="<?php echo url('/admin/login/logout'); ?>">退出登录</a></li>
               <li><a href="<?php echo url('/admin/acount/editpwd'); ?>">修改密码</a></li>
            </ul>
         </li>
         <!--<li class="delete"><a href="#">删除缓存</a></li>-->
      </ul>
   </div>   <div class="contentbox do-clear">      <ul class="menubox">
    <?php if(is_array($menu) || $menu instanceof \think\Collection || $menu instanceof \think\Paginator): $mkey = 0; $__LIST__ = $menu;if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$value): $mod = ($mkey % 2 );++$mkey;?>
    <li <?php if($currentMenu['menu']==$key): ?>class="open"<?php endif; ?>>
        <?php $menuKey = $key; ?>
        <a href="<?php if(isset($value['url'])): ?><?php echo $value['url']; else: ?>javaScript:;<?php endif; ?>"><i class="<?php echo $value['class']; ?>"></i><?php echo $value['title']; ?></a>
        <?php if(!empty($value['nav'])): ?>
        <ul>
        <?php if(is_array($value['nav']) || $value['nav'] instanceof \think\Collection || $value['nav'] instanceof \think\Paginator): $navKey = 0; $__LIST__ = $value['nav'];if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$li): $mod = ($navKey % 2 );++$navKey;?>
            <li <?php if($currentMenu['nav']==$key&&$currentMenu['menu']==$menuKey): ?>class="current"<?php endif; ?>><a href="<?php echo $li['url']; ?>" <?php if(isset($li['target'])): ?>target="<?php echo $li['target']; ?>"<?php endif; ?> ><?php echo $li['title']; ?></a></li>
        <?php endforeach; endif; else: echo "" ;endif; ?>
        </ul>
        <?php endif; ?>
    </li>
    <?php endforeach; endif; else: echo "" ;endif; ?>
</ul>      <div class="rightbox">         <div class="menumap">    <a href="<?php echo url('/user/index'); ?>" class="home">首页</a>    <?php if(isset($menu[$currentMenu['menu']])): ?><a href="javaScript:;"><?php echo $menu[$currentMenu['menu']]['title']; ?></a><?php endif; if(isset($menu[$currentMenu['menu']]['nav'][$currentMenu['nav']])): ?><span><?php echo $menu[$currentMenu['menu']]['nav'][$currentMenu['nav']]['title']; ?></span><?php endif; ?></div>         <div class="canvas">            <link rel="stylesheet" href="<?php echo ADMIN_STYLE_URL; ?>css/warehouse.css" type="text/css" media="screen" />    <script>    $(function(){    warehousetable.planStart();    <?php if(isset($right)): ?>    var kyoPopupMenu={};        kyoPopupMenu = (function(){            return {            sys: function (obj){                $('.popup_menu').remove();                popupMenuApp = $('<div class="popup_menu app-menu"><ul><li><a menu="menu1">查看</a></li><li><a menu="menu2">规划</a></li><li><a menu="menu3">添加材料明细</a></li><li><a menu="menu4">移除</a></li></ul></div>')                        .find('a').attr('href','javascript:;')                        .end().appendTo('body');                //绑定事件                $('.app-menu a[menu="menu1"]').on('click', function (){                                        if($(obj.target).is('label') == false  ||  $(obj.target).attr('class')!='material' ){                       alert('请右键选择库里面的材料');                        $('.popup_menu').hide();                        return;                    }                    var targetId = obj.target.id;                                        var arr = targetId.split('_');                                        targetId = arr[1];                                        openModel.openWindow('<?php echo url('/admin/warehouse/getMaterials','type=bath'); ?>'+'?wtm_id='+targetId);                                       $('.popup_menu').hide();                });                $('.app-menu a[menu="menu2"]').on('click', function (){                     var targetId = obj.target.id;                     if($(obj.target).is('td') == false){                        targetId = $(obj.target).parent().attr('id');                     }                    openModel.openWindow('<?php echo url('/admin/warehouse/showMaterial'); ?>'+'?wt_id='+targetId);                    $('.popup_menu').hide();                                    });                $('.app-menu a[menu="menu3"]').on('click', function (){                                         if($(obj.target).is('label') == false  ||  $(obj.target).attr('class')!='material' ){                       alert('请右键选择库里面的材料');                        $('.popup_menu').hide();                        return;                    }                    var targetId = obj.target.id;                                        var arr = targetId.split('_');                                        targetId = arr[1];                                       openModel.openWindow('<?php echo url('/admin/warehouse/showMaterialDetail'); ?>'+'?wtm_id='+targetId);                                       $('.popup_menu').hide();                                    });                $('.app-menu a[menu="menu4"]').on('click', function (){                                       if($('#'+obj.target.id).is('label') == false){                       alert('请右键点击要操作的原材料！');                       $('.popup_menu').hide();                       return ;                   }                                       if(!confirm('确定移除？')) return ;                                       var namelist = $('#'+obj.target.id).html().split(':');                   var ids = obj.target.id.split("_");                                           warehousetable.delPlan(ids[1]);                                   });                 return popupMenuApp;            }        }})();    //取消右键    $('.product').on('contextmenu', function (){return false;}).click(function(){        $('.popup_menu').hide();    });    //桌面点击右击    $('.product').on('contextmenu',function (e){        var popupmenu = kyoPopupMenu.sys(e);        l = ($(document).width() - e.clientX) < popupmenu.width() ? (e.clientX - popupmenu.width()) : e.clientX;        t = ($(document).height() - e.clientY) < popupmenu.height() ? (e.clientY - popupmenu.height()) : e.clientY;        popupmenu.css({left: l,top: t}).show();        return false;    });    <?php endif; ?>})</script><div class="canvas_title do-clear">    <ul class="tab_nav fl">        <li class="current"><a href="javaScript:void(0)">仓库列表</a></li>    </ul>    </div><div class="canvas_intro">                <br/><br/><br/>   <h5 align='center' class='title'><input type="hidden" id='wttype' value="1"><?php echo $list['name']; ?> 仓库规划</h5>    <input type="hidden" class="epdeletebtn" value="1">    <table class="product" >                        <?php $__FOR_START_1829806153__=$list['x'];$__FOR_END_1829806153__=0;for($i=$__FOR_START_1829806153__;$i > $__FOR_END_1829806153__;$i+=-1){ ?>                    <tr>                                        <?php if(is_array($list['warehousetables']) || $list['warehousetables'] instanceof \think\Collection || $list['warehousetables'] instanceof \think\Paginator): $kt = 0; $__LIST__ = $list['warehousetables'];if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$vt): $mod = ($kt % 2 );++$kt;if($i==$vt['p_x']): $childs = GetEpWarehouseChild($vt['id']); if(!empty($childs)): ?>                                <td name='father' >                                    <table class="productchild"  >                                        <tr>                                            <?php if(is_array($childs) || $childs instanceof \think\Collection || $childs instanceof \think\Paginator): $kc = 0; $__LIST__ = $childs;if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$vc): $mod = ($kc % 2 );++$kc;?>                                            <td name='child' id="<?php echo $vc['id']; ?>"> <input type='hidden' id='volume_<?php echo $vc['id']; ?>' name='volume' value="<?php echo $vc['volume']; ?>"  readonly='readonly' >                                                <?php $materials = GetTargets("select * from ink_ep_warehouse_materialdetail where delete_time is NULL and wt_id=".$vc['id']); if(!empty($materials)): ?>                                                <label  class='labeltitle'><?php echo $vc['name']; ?></label><br>                                                <?php if(is_array($materials) || $materials instanceof \think\Collection || $materials instanceof \think\Paginator): $km = 0; $__LIST__ = $materials;if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$vm): $mod = ($km % 2 );++$km;?>                                                                                                       <label class='material' id="label_<?php echo $vm['id']; ?>" style='white-space:nowrap;'><?php echo $vm['sku']; ?> </label>&nbsp;<a id='deletebtn_<?php echo $vm['id']; ?>' class="deletebtn" style='white-space:nowrap;'>删除</a>                                                    <br>                                                <?php endforeach; endif; else: echo "" ;endif; else: ?>                                                    <label  class='labeltitle' style='white-space:nowrap;'><?php echo $vc['name']; ?><!--                                                     &nbsp;<a class="addbtn">添加</a></label><br>-->                                                <?php endif; ?>                                            </td>                                            <?php endforeach; endif; else: echo "" ;endif; ?>                                        </tr>                                    </table>                                </td>                                <?php else: ?>                                    <td name='father' id="<?php echo $vt['id']; ?>"><input type='hidden' id='volume_<?php echo $vt['id']; ?>' name='volume' value="<?php echo $vt['volume']; ?>" readonly='readonly'>                                        <?php $materials = GetTargets("select * from ink_ep_warehouse_materialdetail where delete_time is NULL and wt_id=".$vt['id']); if(!empty($materials)): ?>                                        <label class='labeltitle'><?php echo $vt['name']; ?></label><br>                                        <?php if(is_array($materials) || $materials instanceof \think\Collection || $materials instanceof \think\Paginator): $km = 0; $__LIST__ = $materials;if( count($__LIST__)==0 ) : echo "" ;else: foreach($__LIST__ as $key=>$vm): $mod = ($km % 2 );++$km;?>                                        <label class='material' id="label_<?php echo $vm['id']; ?>" style='white-space:nowrap;'><?php echo $vm['sku']; ?>&nbsp;</label><a class="deletebtn" id='deletebtn_<?php echo $vm['id']; ?>' style='white-space:nowrap;'>删除</a><br>                                        <?php endforeach; endif; else: echo "" ;endif; else: ?><!--                                            <label  class='labeltitle'style='white-space:nowrap;'><?php echo $vt['name']; ?>&nbsp;<a class="addbtn">添加</a></label><br> -->                                                                                                                                <?php endif; ?>                                    </td>                                <?php endif; endif; endforeach; endif; else: echo "" ;endif; ?>                     </tr>            <?php } ?>    </table>  </div><div class="message" id="tip_windows">    <div class="box">        <h3><label id='title'><label><a href="javaScript:windowoperation.hide($('#tip_windows'))" class="close"><img src="<?php echo ADMIN_STYLE_URL; ?>images/closecut.png" /></a></h3>        <br>           <input name="" type="hidden" value="" id="wtm_id" />        <br>        <li align='center'>            <label id="label_name"></label>                    </li>    <br>        <div class="btn"><a href="javaScript:warehousetable.delPlan('post','','','');">确认</a><a href="javaScript:warehousetable.closeTip();">取消</a></div>    </div></div>         </div>      </div>   </div>   <div class="swf_edit_box" id="swfbox"></div></body></html>